<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">    
    <title>繁化 - 繁簡轉換</title>
    <script type="text/javascript" src="資料/繁化表.js"></script>
    <script type="text/javascript" src="資料/一簡多繁.js"></script>
    <script type="text/javascript" src="資料/正異取捨.js"></script>
    <script type="text/javascript" src="資料/地區用詞/IT.js"></script>
    <script type="text/javascript" src="dom.js"></script>
    <script type="text/javascript" src="字處理.js"></script>
    <script type="text/javascript" src="繁化.js"></script>
    <script type="text/javascript">
      var workspace;
      var 文;
      function input_update() {
	localStorage.input = input.value
	文 = 繁化(input.value)
	container.replaceChild(文.介面, workspace)
	workspace = 文.介面
	workspace.id = 'workspace'
	workspace.style.display = 'none'
	result.value = 文.取得轉換文()
	文.addEventListener('狀態更新', ev => machine_update())
      }
      function machine_update() {
	var 修飾原文 = 文.取得修飾原文()
	var 轉換文 = 文.取得轉換文()
	input.value = 修飾原文
	localStorage.input = 修飾原文
	result.value = 轉換文
      }
      window.addEventListener('load', function() {
	workspace = $('#workspace')
	if ( localStorage.input ) {
	  input.value = localStorage.input
	  input_update()
	}
	var btns = $$('.tag_btn')
	for ( let I of btns ) {
	  let btn = I
	  btn.addEventListener('click', function() {
	    for ( let J of btns ) {
	      J.href = 'javascript:void(0)'
	      $('#'+J.dataset.space).style.display = 'none'
	    }
	    btn.removeAttribute('href')
	    $('#'+btn.dataset.space).style.display = ''
	  })
	}
	input.addEventListener('input', ev => input_update())
	document.body.addEventListener('click', ev => 選擇器.隠藏全部())
	document.body.addEventListener('contextmenu', ev => 選擇器.隠藏全部())
	choice_wrapper.appendChild(生成取捨設定介面())
	choice_wrapper.addEventListener('設定更改', ev => input_update())
      })
    </script>
    <style>
      body {
      font-family: sans-serif;
      background-color: hsl(0, 0%, 90%);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      }
      #container {
      width: 40vw;
      padding: 2.5em;
      margin: 3.6em 0em;
      box-shadow: 0 3px 9px hsla(0, 0%, 40%, 0.3);
      background-color: white;
      background-image: linear-gradient(to bottom, hsl(0, 0%, 98%), hsl(0, 0%, 99%));
      }
      #nav_bar {
      margin: 0.3em 0em;
      }
      #input, #result {
      width: 100%;
      height: 20em;
      resize: none;
      font-size: 1.1em;
      padding: 0.2em 0.4em;
      }
      
      a { text-decoration: none; outline: none; }
      a, a:visited { color: color: hsl(233, 80%, 48%); }
    </style>
    <style>
      .選擇面板 { border: 1px solid hsl(0, 0%, 85%); }
      .選擇面板 { width: 13.5em; margin-top: 0.2em; }
      .選擇面板 { background-color: hsla(50, 1%, 97%, 0.97); }
      .選擇面板 { box-shadow: 0 4px 10px hsla(0, 0%, 35%, 0.4); }
      .選項 { display: flex; justify-content: space-between; }
      .選項, .注解 { padding: 0.15em 0.6em; }
      .選項 { cursor: pointer; }
      .選項:hover { background-color: hsla(68, 91%, 75%, 0.97); }
      .候選字 { font-size: 1.2em; color: hsl(0, 0%, 2%); }
      .例詞表 { display: flex; align-items: center; }
      .例詞 { margin-left: 0.25em;  }
      .例詞 { color: hsl(0, 0%, 12%); }
      .注解 { color: color: hsl(0, 0%, 6%); }
      .字位 { border: 1px solid hsl(0, 0%, 100%, 0); border-radius: 2px; }
      .字位 { padding: 0.15em; margin: 0.25em 0.1em; }
      .字位 { font-family: sans-serif; font-size: 1.1em; }
      .字位 { color: hsl(0, 0%, 10%); }
      .字位.一對多字 { cursor: pointer; }
      .字位.一對一字, .字位.無對應字 { color: hsl(0, 0%, 30%); }
      .字位[data-狀態=未選擇] { background-color: hsl(55, 90%, 60%); }
      .字位[data-狀態=已選擇] { background-color: hsl(127, 90%, 70%); }
      .正異取捨設定 { column-count: 4; }
      .正異條目 { display: flex; }
      .正異選項 { flex-grow: 1; padding: 0.3em 0em; margin: 0.3em 0em; }
      .正異選項 { font-size: 1.35em; text-align: center; }
      .正異選項 { cursor: pointer; }
      .正異選項[data-selected=true] {
      color: hsl(0, 0%, 10%);
      background-color: hsl(55, 90%, 60%);
      }
      .正異選項[data-selected=false] {
      color: hsl(0, 0%, 97%);
      background-color: hsl(0, 0%, 60%);
      }
    </style>
  </head>
  <body>
    <div id="container">
      <h1>繁化</h1>
      <hr/>
      <div id="nav_bar">
	<a class="tag_btn" data-space="inputspace">
	  【簡体原文】
	</a>
	<a class="tag_btn" data-space="workspace" href="javascript:void(0)">
	  【繁化器】
	</a>
	<a class="tag_btn" data-space="resultspace" href="javascript:void(0)">
	  【繁化結果】
	</a>
	<a class="tag_btn" data-space="settingspace" href="javascript:void(0)">
	  【設定】
	</a>
      </div>
      <div id="inputspace">
	<textarea id="input" placeholder="鍵入簡體文章後點選上方【繁化器】以進行繁化。"></textarea>
	<br/>
      </div>
      <div id="workspace" style="display:none;">
      </div>
      <div id="resultspace" style="display:none;">
	<textarea id="result" readonly="readonly"></textarea>
      </div>
      <div id="settingspace" style="display:none;">
	<div id="choice_wrapper">
	  <h3>正異取捨</h3>
	</div>
      </div>
    </div>
  </body>
</html>
